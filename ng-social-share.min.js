"use strict";!function(o){function e(o,e){e=e&&e.toLowerCase();for(var t="",n=0,r="a"==e?10:0,i="n"==e?10:62;n++<o;){var c=Math.random()*(i-r)+r<<0;t+=String.fromCharCode(c+=c>9?36>c?55:61:48)}return t}function t(o,e,t){var n=document.getElementById(e);return e&&n?(t&&t(),n):(console.log(o),n=document.createElement("script"),n.id=e,n.type="text/javascript",n.async=!0,n.src=o,n.onload=t,document.body.appendChild(n),n)}var n,r=o.module("educ.ngSocialShare",[]),i={},c="en_US",a=!0,u={facebook:function(o,e,n){t("https://connect.facebook.net/"+e+"/all.js","facebook-sdk",function(){window.fbAsyncInit||(window.fbAsyncInit=function(){window.FB.init({appId:o,channelUrl:"app/channel.html",status:!0,xfbml:!0})}),n&&n()})},googleplus:function(o,e,n){window.___gcfg||(window.___gcfg={lang:e.replace("_","-").toLocaleLowerCase()}),t("https://apis.google.com/js/platform.js","googleplus-sdk",n)},twitter:function(o,e,t){t&&t()}};r.provider("socialShare",function(){this.$get=[function(){}],this.setLocale=function(o){return c=o,this},this.setNeedShares=function(o){return a=!!o,this},this.register=function(o,e){return i[o]=e,this}}),r.run(["$http",function(o){n=function(){return{getFacebookCount:function(o,e){t("https://graph.facebook.com/?id="+encodeURIComponent(o)+"&callback="+encodeURIComponent(e),e)},getTwitterCount:function(o,e){t("http://urls.api.twitter.com/1/urls/count.json?url="+encodeURIComponent(o)+"&callback="+encodeURIComponent(e),e)},getGooglePlusCount:function(e,t){o.post("https://clients6.google.com/rpc?key="+encodeURIComponent(i.googleplus),{data:{method:"pos.plusones.get",id:"p",params:{nolog:!0,id:e,source:"widget",userId:"@viewer",groupId:"@self"},jsonrpc:"2.0",key:"p",apiVersion:"v1"}}).success(function(o){o.data?o.data.result?(console.error(t,o.data.result),window[t](o.data.result,null)):o.data.error&&(console.error(t,o.data.error),window[t](null,o.data.error)):console.error(t,o)}).error(function(o){console.error(t,o),window[t](null,o)})}}}()}]),r.directive("facebookShare",["$timeout",function(t){return{scope:!0,link:function(r,l,s){u.facebook(i.facebook,c),a&&s.$observe("url",function(){if(s.url){var o="facebook_jsonp_"+e(10,"a");window[o]=function(o,e,n,r){return function(e){t(function(){o.facebook=e,o.facebook.shares=o.facebook.shares||0,delete window[r],document.getElementById(r).remove()})}}(r,l,s,o),n.getFacebookCount(s.url,o)}}),l.off(),l.on("click",function(e){s.url&&window.FB&&window.FB.ui({method:"share_open_graph",action_type:"share",action_properties:JSON.stringify({object:{scrape:o.isDefined(s.scrape)?"false"!==s.scrape:!0,url:s.url,title:s.title||s.url,image:s.image||"",description:s.description||""}})},function(o){o&&o.error&&console.error("Facebook error : "+o.error.message)}),e.stopPropagation(),e.preventDefault()})}}}]),r.directive("twitterShare",["$timeout",function(t){return{scope:!0,link:function(r,i,u){function l(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var i=t?t+"["+r+"]":r,c=e[r];n.push(o.isObject(c)?l(c,i):encodeURIComponent(i)+"="+encodeURIComponent(c))}return n.join("&")}function s(o,e,t,n,r){var i=0,c=0,a=0,u=0;window.screenX?(i=parseInt(window.screenX),c=parseInt(window.screenY),a=parseInt(window.outerWidth),u=parseInt(window.outerHeight)):window.screen&&(i=0,c=0,a=parseInt(window.screen.width),u=parseInt(window.screen.height)),t=t?parseInt(t):Math.round(a/2),n=n?parseInt(n):Math.round(u/2),r=r||"";var l=i;a>t&&(l+=Math.round((a-t)/2));var s=c;return u>n&&(s+=Math.round((u-n)/2)),window.open(o,e,"left="+l+"px,top="+s+"px,width="+t+"px,height="+n+"px"+r)}var p="en";switch(c){case"fr_FR":p="fr";break;case"en_US":p="en"}a&&u.$observe("url",function(){if(u.url){var o="twitter_jsonp_"+e(10,"a");window[o]=function(o,e,n,r){return function(e){t(function(){o.twitter=e,o.twitter.count=o.twitter.count||0,delete window[r],document.getElementById(r).remove()})}}(r,i,u,o),n.getTwitterCount(u.url,o)}}),i.off(),i.on("click",function(o){if(u.url){var e={lang:p,url:u.url||"",hashtags:u.hashtags||"",count:a?u.count:"none",via:u.via||"",text:u.text||"",size:u.size||"",align:u.align||"",counturl:u.counturl||""},t="http://twitter.com/share?"+l(e);s(t,"twitter",640,400)}o.preventDefault(),o.stopPropagation()})}}}]),r.directive("googleplusShare",[function(){return{scope:!0,link:function(o,t,r){a&&r.$observe("contenturl",function(){if(r.contenturl){var i="googleplus_jsonp_"+e(10,"a");window[i]=function(o,e,t,n){return function(e,t){o.googleplus=e,delete window[n]}}(o,t,r,i),n.getGooglePlusCount(r.url,i)}});var l=function(o,e,t){return function(){if(window.gapi){var o={};o.clientid=i.googleplus,o.contenturl=t.contenturl||"",o.calltoactionlabel=t.calltoactionlabel||"",o.calltoactionurl=t.calltoactionurl||"",o.prefilltext=t.prefilltext||"",o.cookiepolicy=t.cookiepolicy||"single_host_origin",o.onshare=function(o){console.log("onshare",o)},window.gapi.interactivepost.render(e.get(0),o)}}}(o,t,r);u.googleplus(i.googleplus,c,l),r.$observe("contenturl",l),r.$observe("calltoactionurl",l),r.$observe("calltoactionlabel",l),r.$observe("prefilltext",l)}}}])}(angular);